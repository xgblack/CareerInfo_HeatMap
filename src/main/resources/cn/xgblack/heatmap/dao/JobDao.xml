<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.xgblack.heatmap.dao.JobDao">
    <sql id="searchCondition" >
        <where>
            <if test="cname != null">
                AND cname LIKE CONCAT('%',#{cname},'%')
            </if>
            <if test="jname != null">
                AND jname LIKE CONCAT('%',#{jname},'%')
            </if>
            <if test="province != null">
                AND province LIKE CONCAT('%',#{province},'%')
            </if>
            <if test="minwage != null and minwage > 0">
                AND minwage >= #{minwage}
            </if>
        </where>
    </sql>
    <!-- 查询总记录数（无查询条件）-->
    <select id="findTotalCount" resultType="Integer" parameterType="map">
        SELECT COUNT(jid) FROM job
        <include refid="searchCondition"></include>
    </select>

    <select id="findByPage" resultType="cn.xgblack.heatmap.domain.Job">
        SELECT jid,cname,jname,lon,lat,minwage,maxwage,province,highlights,erequir FROM job
        <include refid="searchCondition"></include>
        LIMIT #{start},#{rows}
    </select>
</mapper>